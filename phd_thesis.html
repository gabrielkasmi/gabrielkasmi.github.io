<!doctype html>
<html>
  <head>
  	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-133810388-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-133810388-1');
	</script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>PhD thesis | Gabriel Kasmi</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  
  <body>
    <div class="wrapper">
      <header>
        <h1 class="title">PhD thesis</h1>
        <img src="assets/poster.jpeg" alt="Gabriel Kasmi" class="picture" style="max-width: 80%; height: auto;" />
        <!-- Add other header elements as needed -->
        <ul>
          <li><a href="#Motivation">Context</a></li>
          <li><a href="#Pilars">Reliability pilars</a></li>
          <li><a href="#Observability">Improving observability</a></li>
          <li><a href="#Conclusion">Conclusion</a></li>
          <li><a href="#Material">Manuscript and slides</a></li>

          <li><a href="research.html">Back to research</a></li>
          <li><a href="index.html">Back to home</a></li>
       </ul>
      </header>
      <section> 

        <h2 id="Motivation">Motivation and context</h2>

        <p>
          In the current organization of the electric system, the transmission system operator (TSO) 
        is reponsible for the balance betwee the load and supply of electricity. It requires to have
        access to real time measurements of the electric production. While for conventional electricity 
        generation means, wind and hydro power, this does not pose any problem, photovoltaic (PV) energy
        is characterized by a great diversity of systems, ranging from large plants, which are telemetered,
        to small scale, distributed systems. These systems, generally located on rooftop and whose installed 
        capacity is lower than 36 kWp, amount for 20% of the PV installed capacity and are poorly known by the TSO.
        This poor knowledge regarding small scale PV systems not only concerns power measurements, but also
        the knowledge regarding the actuall fleet of systems (localization, individual installed capacity, system characteristics).
        </p>

        <p>
          The rapid growth of PV energy in the context of the energy transition will increase the share of PV energy
          in the electric mix. To continue to ensure the stability of the grid, it will be necessary to increase
          the rooftop PV observability, i.e., the ability of the TSO to estimate the rooftop PV power with good accuracy.
          To this end, two steps are necessary: first increasing the knowledge of the rooftop PV fleet and second leveraging
          this registry to estimate the rooftop PV power production.
        </p>

        <p>
          In the recent years, numerous works leveraged deep learning and orthoimagery to to construct registries of small-scale
          PV systems [1,2,3]. Among them, the DeepSolar project [4] was an important milestone as it was among the
          first work to construct a large-scale database of PV systems recording the surface and the localization of the systems.
        </p>
        
        <h2>Scientific question</h2>

        <p>
          Unfortunately, we cannot straightforwarly apply DeepSolar to France as we need more information on the PV systems
          than only the surface. As our goal is to estimate the PV power production, we need the installed capacity, tilt and azimuth
          angles of the PV systems, which are the minimal necessary information to estimate the PV power production [5]. 
        </p>

        <p>
          The fundamental limit to deep learning-based methods such as DeepSolar is their sensitivity to distribution shifts, 
          which leads to an unpredictable loss in accuracy if we were to apply the algorithm straightfowardly to France.
          This sensitivity to distribution shifts results in a lack of reliability of deep learning methods.
        </p>

        <p>
          The central contribution of this work is therefore to introduce a framework intended to improve the 
          reliability of deep learning algorithms intended to be used in critical industrial processes such as the 
          remote sensing of rooftop PV systems. The scientific question addressed is the following: Is deep learning-based 
          remote sensing on orthoimagery a suitable method for constructing a nationwide registry of rooftop photovoltaic (PV) 
          installations intended to improve the observability of PV power production in France?
        </p>

        <h2 id="Pilars">The three pilars of reliability</h2>

        <p>
          The framework for improving the reliability of deep learning-based algorithms is based on the following 
          three pilars:
          <ul>
            <li>
              <strong><a href="#pilar1">Monitoring</a></strong>: as deep learning models can fail unpredictably, it is necessary to 
              monitor their accuracy over they operational design domain (ODD, [6]), i.e., the data on which they are used in production.
              This evaluation is at most indirect, as by definition there is not labelled data on this domain.
            </li>
            <li>
              <strong>Auditing</strong>: we argue that it is necessary to gain intuition on how models work to be able 
              to understand when they might fail and what the practitioner can expect from them. To this end, we leverage explainable AI (XAI)
              techniques. These methods enable to understand how model works, e.g., by shedding light on the important areas
              on an image for making a prediction. 
            </li>
            <li>
              <strong>Robustness</strong>: when deployed in production, the input data will be subject to some alterations. 
              While it seems hard to improve the robustness in general, we can at least identify the main source of variability 
              in the input data and improve the model's invariance to such alterations. 
            </li>
          </ul>
        </p>

        <details>
          <summary>
            <h3 id="pilar1">
              Monitoring: the downstream task accuracy
            </h3>
        </summary>
        <div>

        <p>
          With the monitoring, we aim at being able to keep track of the model's performance over its ODD.
          In our case, we trained a model on a training dataset and we deploy it over <a href="https://geoservices.ign.fr/bdortho">IGN orthoimages</a> 
          covering all France. Therefore, our ODD, which we call the mapping area is France. 
        </p>

        <p>
          The standard way of evaluating a model's accuracy is to compare its prediction against ground
          truth labels. Over France, we do not have such ground truth labels so instead we have to rely on
          the closest available data, which is the <a href="https://odre.opendatasoft.com/explore/dataset/registre-national-installation-production-stockage-electricite-agrege/information/?disjunctive.epci&disjunctive.departement&disjunctive.region&disjunctive.filiere&disjunctive.combustible&disjunctive.combustiblessecondaires&disjunctive.technologie&disjunctive.regime&disjunctive.gestionnaire"><i>Registre national d'installations</i> (RNI)</a>.
          The RNI indicates for each city the total number of installations and the cumulated installed capacity. 
        </p>

        <p>
          To monitor the accuracy of the registry with the RNI, we rely on unsupervised model evaluation methods [7].
          These approaches consist in automatically comparing the outputs of the model with an external data source. 
          In our case, we aggregate the detections of our detection model to obtain an estimation of the installed capacity 
          and the number of installations. We then compare these estimations with the records of the RNI.
          We called this method the <a href="https://arxiv.org/abs/2207.07466">downstream task accuracy (DTA)</a> 
          as it enables to evaluate a model's accuracy according to metrics that are relevant for the downstream
          or final users: for instance, we can compute the average error in the estimation of the aggregated installed capacity,
          and derive metrics indicating whether the model locally overestimates or underestimates the aggregated installed capacity.
        </p>

        <figure>
          <img src="assets/ratio.png" alt="DTA" style="max-width: 100%; height: auto;">
          <figcaption>Comparison of the aggregated installed capacity estimated by the model and recorded in the RNI, and 
            "normalized ratio" between the estimation and the reference. Each polygon is a city. The bluer, the stronger the underestimation
            and the redder, the stronger the overestimation of the aggregated installed capacity by the mapping algorithm.
          </figcaption>
        </figure>


        <p>
          In [8], we leveraged the DTA to show that the performance of the model varies greatly during its deployment.
            We were also able to quantify the performance drop encountered by rooftop PV mapping algorithms which was
            highlighted by earlier works [9,10]. Deploying a model based on [3] and fine-tuned over France using the 
            <a href="https://www.nature.com/articles/s41597-023-01951-4">BDAPPV dataset</a> [11], we documented
            a 30 percentage point accuuracy drop when shifting from the training dataset to the mapping area. 
            The main question that arises is to understand why such performance drop occurs.
        </p>
      </div>
      </details>

        <h3>Auditing: the wavelet scale attribution method</h3>

        <p>
          The aim of this part is to assess whether the model detects PV panels for correct reasons. By correct,
        we mean that the model should detect PV panels by relying on relevant components on the image and not spurious
        factors (e.g. rooftop or nearby objects such as pools). To carry out this assessment, we initially relied 
        on a class of feature attribution method called the Gradient Class Activation Map (GradCAM, [12]). 
        This method highlights the areas on the input image that contributed the most to a model's decision. 
        </p>

        <p>
          The GradCAM was sufficient to reveal that the model does not rely on spurious factor and focuses where
          PV panels are located. However, it failed to explain false positives and false negatives. A thourought 
          analysis of these failure cases led us to suppose that they were caused by the fact that the model
          relies on different <i>scales</i>, and that depending on whether patterns are present at different scales
          false predictions can arise.
        </p>

        <p>
          In other words, to better understand why false prediction arise, we need to assess what does the 
          model see on the input image and not only where it looks, as traditional feature attribution methods do.
          Towards this end, we introduced the <a href="https://arxiv.org/abs/2305.14979">wavelet scale attribution method (WCAM)</a>.
        </p>

        
        <figure>
            <img src="assets/explanation.png" alt="DeepPVMapper" style="max-width: 80%; height: auto;">
            <figcaption>WCAM method: highlighting the important wavelet coefficients in a model's prediction. 
              <a href="https://arxiv.org/abs/2305.14979">Source</a>.
            </figcaption>
          </figure>

        <h3>Robustness: building DeepPVMapper</h3>

        <a href="https://arxiv.org/abs/2309.07143">PyPVRoof</a>
        <a href="https://arxiv.org/abs/2309.12214">wavelet perturbation</a>


        <h2 id="Observability">Assessing the impact on rooftop PV observability</h2>

        <figure>
            <img src="assets/final.png" alt="DeepPVMapper" style="max-width: 80%; height: auto;">
            <figcaption>Overview of the French départements mapped with DeepPVMapper (as of 04/2024).</figcaption>
          </figure>

        <h2 id="Conclusion">Conclusion</h2>
        
        <p>Through this PhD, I made contributions in machine 
          learning and explainable AI, with the introduction of the wavelet 
          scale attribution method (WCAM) and new feature attribution method. 
          I also made contribution in power systems with the introduction 
          of a new algorithm for mapping rooftop PV systems (DeepPVMapper) 
          and the associated database, which is currently the world largest 
          with  this level of detail.
        </p>

        <h2>References</h2>

        <p>
          <ol>
            <li>Malof, J. M., Bradbury, K., Collins, L. M., & Newell, R. G. (2016). 
              Automatic detection of solar photovoltaic arrays in high resolution aerial imagery. 
              <i>Applied energy, 183</i>, 229-240.</li>
              <li>
                Kausika, B. B., Nijmeijer, D., Reimerink, I., Brouwer, P., & Liem, V. (2021). 
                GeoAI for detection of solar photovoltaic installations in the Netherlands. 
                <i>Energy and AI, 6</i>, 100111.
              </li>
              <li>
                Mayer, K., Rausch, B., Arlt, M. L., Gust, G., Wang, Z., Neumann, D., & Rajagopal, R. (2022). 
                3D-PV-Locator: Large-scale detection of rooftop-mounted photovoltaic systems in 3D. 
                <i>Applied Energy, 310</i>, 118469.
              </li>
              <li>
                Yu, J., Wang, Z., Majumdar, A., & Rajagopal, R. (2018). 
                DeepSolar: A machine learning framework to efficiently construct a solar 
                deployment database in the United States. <i>Joule, 2</i>(12), 2605-2617.
              </li>
              <li>
                Saint-Drenan, Y. M., Bofinger, S., Fritz, R., Vogt, S., Good, G. H., & Dobschinski, J. (2015).
                 An empirical approach to parameterizing photovoltaic plants for power 
                 forecasting and simulation. <i>Solar Energy, 120</i>, 479-493.
              </li>
              <li>
                Boisnard, F., Boumazouza, R., Ducoffe, M., Fel, T., Glize, E., Hervier, L., ... & Vigouroux, D. (2023). 
                Guidelines to explain machine learning algorithms.
              </li>
              <li>
                Zhang, H., Fritts, J. E., & Goldman, S. A. (2008). 
                Image segmentation evaluation: A survey of unsupervised methods. 
                <i>Computer vision and image understanding, 110</i>(2), 260-280.
              </li>
              <li>
                Kasmi, G., Dubus, L., Blanc, P., & Saint-Drenan, Y. M. (2022). 
            Towards unsupervised assessment with open-source data of the accuracy of deep 
            learning-based distributed PV mapping. <i>In MACLEAN: MAChine Learning for EArth 
              ObservatioN Workshop co-located with the European Conference on Machine 
              Learning and Principles and Practice of Knowledge Discovery in 
              Databases (ECML/PKDD 2022)</i>
              </li>
              <li>
                De Jong, T., Bromuri, S., Chang, X., Debusschere, M., Rosenski, N., Schartner, C., ... 
                & Curier, L. (2020). Monitoring spatial sustainable development: semi-automated analysis 
                of satellite and aerial images for energy transition and sustainability indicators. 
                <i>arXiv preprint arXiv:2009.05738.</i>
              </li>
              <li>
                Malof, J. M., Li, B., Huang, B., Bradbury, K., & Stretslov, A. (2019). 
                Mapping solar array location, size, and capacity using deep learning and overhead 
                imagery. <i>Preprint at https://arxiv. org/abs/1902.10895.</i>
              </li>
              <li>
                Kasmi, G., Saint-Drenan, Y. M., Trebosc, D., Jolivet, R., Leloux, J., Sarr, B., & Dubus, L. (2023). 
                A crowdsourced dataset of aerial images with annotated 
                solar photovoltaic arrays and installation metadata. <i>Scientific Data 10</i>(1), 59.
              </li>
              <li>
                Selvaraju, R. R., Cogswell, M., Das, A., Vedantam, R., Parikh, D., & Batra, D. (2017). 
                Grad-cam: Visual explanations from deep networks via gradient-based localization. 
                <i>In Proceedings of the IEEE international conference on computer vision </i>(pp. 618-626).
              </li>
          </ol>
        </p>

        <h2 id="Material">Manuscript and slides</h2>

        <p>The manuscript and the slides of the defense will soon be accessible. The thesis page on thèses.fr can be accessed 
          <a href="https://theses.fr/s262404">here</a>.

          <!--
            Slides
            <a href="https://docs.google.com/presentation/d/1TiIZZ0JEbI8K9W1--Jmif7_p5JDSsJIF/edit?usp=drive_link&ouid=105935550887435734242&rtpof=true&sd=true">
              here</a>.
          -->
        </p>
        
      </section>
    </div>
    <script src="javascripts/scale.fix.js"></script>
  </body>
</html>
